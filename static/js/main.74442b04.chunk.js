(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{150:function(e,t,n){e.exports=n(345)},345:function(e,t,n){"use strict";n.r(t);n(151),n(153);var a=n(1),r=n.n(a),c=n(61),s=n.n(c),o=n(62),u=n(142),i=n(143),l=n(148),p=n(144),d=n(149),f=n(76),m=n.n(f),h=n(53),b=n(9),v=n(29),E=n.n(v),g=n(55),w=n(46),_=function(){var e=Object(g.a)(E.a.mark(function e(t,n){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.send("VKWebAppCallAPIMethod",{method:"groups.get",params:{user_id:n,fields:"members_count",extended:!0,v:"5.95",access_token:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(g.a)(E.a.mark(function e(t,n){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.send("VKWebAppCallAPIMethod",{method:"friends.get",params:{user_id:n,order:"random",fields:"photo_100",name_case:"nom",v:"5.95",access_token:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),y="MAIN_CHANGE_VIEW",k="MAIN_CHANGE_PANEL",O="MAIN_CHANGE_FETCHED_USER",j="MAIN_CHANGE_USER_GROUPS",U="MAIN_CHANGE_USER_FRIENDS",V="MAIN_CHANGE_AUTH_TOKEN",G={activeView:"main",activePanel:"main",fetchedUser:null,userGroups:[],userFriends:[],authToken:null},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case y:return Object(w.a)({},e,{activeView:n.view,activePanel:n.panel});case k:return Object(w.a)({},e,{activePanel:n});case O:return Object(w.a)({},e,{fetchedUser:n});case j:return Object(w.a)({},e,{userGroups:n});case U:return Object(w.a)({},e,{userFriends:n});case V:return Object(w.a)({},e,{authToken:n});default:return e}},T=n(147),P=function(e){var t=e.userGroups;return r.a.createElement(b.List,null,t.map(function(e){return r.a.createElement(b.Cell,{key:e.id,before:r.a.createElement(b.Avatar,{src:e.photo_200}),description:"".concat(e.members_count," \u041f\u043e\u0434\u043f\u0438\u0441\u0447\u0438\u043a\u043e\u0432")},e.name)}))},C=function(e){var t=e.userFriends;return r.a.createElement(b.List,null,t.map(function(e){return r.a.createElement(b.Cell,{key:e.id,before:r.a.createElement(b.Avatar,{size:48,src:e.photo_100})},e.first_name," ",e.last_name)}))},N={fetchUserGroups:function(e,t){return function(){var n=Object(g.a)(E.a.mark(function n(a){return E.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:_(e,t).then(function(e){var t=e.data.response.items;console.log("new groups: ",t),a({type:j,payload:t})});case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()},fetchUserFriends:function(e,t){return function(){var n=Object(g.a)(E.a.mark(function n(a){return E.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:A(e,t).then(function(e){var t=e.data.response.items;console.log("new friends: ",t),a({type:U,payload:t})});case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}},F=Object(h.b)(function(e){return e.main},N)(function(e){e.changeView,e.changePanel;var t=e.fetchUserGroups,n=e.fetchUserFriends,c=e.userGroups,s=e.userFriends,o=e.fetchedUser,u=e.authToken,i=Object(a.useState)("groups"),l=Object(T.a)(i,2),p=l[0],d=l[1];o&&u&&0===c.length&&(t(u,o.id),n(u,o.id));return r.a.createElement(a.Fragment,null,r.a.createElement(b.PanelHeader,{noShadow:!0},"\u041c\u043e\u0439 \u043f\u0430\u0431\u043b\u0438\u043a"),r.a.createElement(b.FixedLayout,{vertical:"top"},r.a.createElement(b.Tabs,{type:"buttons",theme:"header"},r.a.createElement(b.HorizontalScroll,null,r.a.createElement(b.TabsItem,{onClick:function(){d("groups")},selected:"groups"===p},"\u041c\u043e\u0438 \u0433\u0440\u0443\u043f\u043f\u044b"),r.a.createElement(b.TabsItem,{onClick:function(){d("friends")},selected:"friends"===p},"\u041c\u043e\u0438 \u0434\u0440\u0443\u0437\u044c\u044f"),r.a.createElement(b.TabsItem,{onClick:function(){d("friendsRecommendations")},selected:"friendsRecommendations"===p},"\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0437\u0435\u0439")))),r.a.createElement("div",{id:"content",style:{marginTop:"50px"}},function(e){switch(e){case"groups":return r.a.createElement(P,{userGroups:c});case"friends":return r.a.createElement(C,{userFriends:s});default:return r.a.createElement("div",null,"default")}}(p)))}),x=(n(344),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e))).go=function(e){n.setState({activePanel:e.currentTarget.dataset.to})},n.state={activeView:"main",activePanel:"main",fetchedUser:null,authToken:null},n}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.changeFetchedUser,n=e.changeAuthToken;m.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppGetUserInfoResult":t(e.detail.data);break;case"VKWebAppAccessTokenReceived":n(e.detail.data.access_token);break;default:console.log(e.detail.type)}}),m.a.send("VKWebAppGetUserInfo",{}),m.a.send("VKWebAppGetAuthToken",{app_id:6921887,scope:"groups,friends"})}},{key:"render",value:function(){return r.a.createElement(b.Root,{activeView:this.state.activeView},r.a.createElement(b.View,{id:"main",activePanel:"main"},r.a.createElement(b.Panel,{id:"main"},r.a.createElement(F,{changeView:this.changeView,changePanel:this.changePanel}))))}}]),t}(r.a.Component)),H={changeView:function(e,t){return function(n){n({type:y,payload:{view:e,panel:t}})}},changePanel:function(e){return function(t){console.log("new panel: ",e),t({type:k,payload:e})}},changeFetchedUser:function(e){return function(t){console.log("new fetchedUser: ",e),t({type:O,payload:e})}},changeAuthToken:function(e){return function(t){console.log("new token: ",e),t({type:V,payload:e})}}},R=Object(h.b)(function(e){return e.main},H)(x),M=n(54),S=n(146),K={main:I},W=Object(M.d)(Object(M.c)(K),Object(M.a)(S.a));o.a.send("VKWebAppInit",{}),s.a.render(r.a.createElement(h.a,{store:W},r.a.createElement(R,null)),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.74442b04.chunk.js.map